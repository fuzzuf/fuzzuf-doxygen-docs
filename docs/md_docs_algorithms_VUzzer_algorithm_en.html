<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fuzzuf: VUzzer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">fuzzuf
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">VUzzer </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md382"></a>
What is VUzzer</h1>
<p><a href="https://github.com/vusec/vuzzer64">https://github.com/vusec/vuzzer64</a></p>
<p>VUzzer[^ndss17] is a mutation-based fuzzer proposed at NDSS 2017 that attempt to discover unknown execution paths by modifying one or more seeds selected from the queue.</p>
<p>The main feature of VUzzer is that it tries to estimate data structures from the PUT control flow and the data flow to find the execution paths efficiently without any knowledge of the source code or input formats. It has been a pioneer in application-aware fuzzer without prior knowledge.</p>
<h1><a class="anchor" id="autotoc_md383"></a>
Prerequisite</h1>
<p>VUzzer PUT requires static analysis with IDAPython and instrumentation with PolyTracker before fuzzing. Install fuzzuf, Intel Pin, and PolyTracker as described in build_en.md, and follow the instruction below.</p>
<h2><a class="anchor" id="autotoc_md384"></a>
Disable ASLR</h2>
<p>VUzzer uses the passed basic block addresses for coverage, so we must disable ASLR before running.</p>
<div class="fragment"><div class="line">sudo sysctl -w kernel.randomize_va_space=0</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md385"></a>
Mount tmpfs</h2>
<p>PolyTracker writes propagated taint information to the database on taint analysis. We highly recommend using tmpfs for the database location because it is an I/O-intensive workload.</p>
<div class="fragment"><div class="line">sudo mkdir -p /mnt/polytracker</div>
<div class="line">sudo mount -t tmpfs -o size=100m tmpfs /mnt/polytracker</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md386"></a>
Instrumentation with PolyTracker</h2>
<div class="fragment"><div class="line">cd build</div>
<div class="line">mkdir vuzzer_test</div>
<div class="line">cp test/put_binaries/calc/calc.c ./vuzzer_test</div>
<div class="line">cd vuzzer_test</div>
<div class="line">polybuild --instrument-target -g -o instrumented.bin calc.c</div>
</div><!-- fragment --><p>The <code>instrumented.bin</code> is a <code>calc</code> binary with taint analysis operations instrumented by <code>polybuild</code>.</p>
<h1><a class="anchor" id="autotoc_md387"></a>
Static Analysis with IDAPython</h1>
<div class="fragment"><div class="line">gcc -o calc calc.c</div>
<div class="line">/path/to/idat64 -A -S../../tools/bbweight/bb-weight-ida.py calc</div>
</div><!-- fragment --><p>The last command will generate three files in total: two dictionary files <code>unique.dict</code> and <code>full.dict</code>, and the weighted PUT control flow graph (CFG) file <code>weight</code>.</p>
<p>After the above steps, you can find the following files in <code>vuzzer_test</code> directory if the build succeeded.</p>
<div class="fragment"><div class="line">calc</div>
<div class="line">calc.c</div>
<div class="line">full.dict</div>
<div class="line">instrumented.bc</div>
<div class="line">instrumented.bin</div>
<div class="line">instrumented_instrumented.bc</div>
<div class="line">instrumented_instrumented.o</div>
<div class="line">unique.dict</div>
<div class="line">weight</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md388"></a>
Usage on CLI</h1>
<p>Run the following command in <code>vuzzer_test</code> directory:</p>
<div class="fragment"><div class="line">../fuzzuf vuzzer --in_dir=../test/put_binaries/calc/seeds -- ./calc @@</div>
</div><!-- fragment --><p>Place <b>three or more</b> initial seeds in the directory specified with <code>--indir</code>.</p>
<p>The available options:</p>
<ul>
<li>Global options (available for all fuzzers on <code>fuzzuf</code>)<ul>
<li><code>--out_dir=path/to/output/directory</code><ul>
<li>Specifies a path to the directory, where all the outputs from fuzzers go, such as crash seeds. The default path <code>/tmp/fuzzuf-out_dir</code> is used if not specified.</li>
</ul>
</li>
<li><code>--exec_timelimit_ms=1234</code><ul>
<li>Specifies a time limit per PUT execution in milliseconds. The default time limit is 1 second (i.e. 1000 ms).</li>
</ul>
</li>
<li><code>--exec_memlimit=1234</code><ul>
<li>Specifies the amount of memory available per PUT execution in megabytes. The default memory limit is 25 MB in 64-bit environment, and 50 MB in 32-bit environment.</li>
</ul>
</li>
<li><code>--log_file=path/to/log/file</code><ul>
<li>Specifies a path to the file, where log outputs (and debug-log outputs if built with debug mode) go. Logs are printed to stdout if a path is not specified.</li>
</ul>
</li>
</ul>
</li>
<li>Local options (available for VUzzer only)<ul>
<li><code>--full_dict=path/to/full.dict</code><ul>
<li>Specifies the path to the full dictionary file generated by <code>bb-weight.py</code>. This dictionary holds all magic numbers exist in the PUT binary. Default to <code>./full.dict</code> if not specified.</li>
</ul>
</li>
<li><code>--unique_dict=path/to/unique.dict</code><ul>
<li>Specifies the path to the unique dictionary file generated by <code>bb-weight.py</code>. This dictionary holds deduplicated magic numbers exist in the PUT binary. Default to <code>./unique.dict</code> if not specified.</li>
</ul>
</li>
<li><code>--weight=path/to/weight/file</code><ul>
<li>Specifies the path to the weight file generated by <code>bb-weight.py</code>. This file holds scores for each node based on the PUT control flow graph (CFG) analysis. Default to <code>./weight</code> if not specified.</li>
</ul>
</li>
<li><code>--inst_bin=path/to/instrumented/bin</code><ul>
<li>Specifies the path to the executable instrumented by <code>polybuild</code>. Default to <code>./instrumented.bin</code> if not specified.</li>
</ul>
</li>
<li><code>--taint_db=path/to/taint/db</code><ul>
<li>Specifies the path to the taint information database. Default to <code>/mnt/polytracker/polytracker.db</code> if not specified.</li>
</ul>
</li>
<li><code>--taint_out=path/to/taint/db</code><ul>
<li>Specifies the path to the file where taint information is recorded. This file holds the taint information related to <code>lea</code> and <code>cmp</code> instructions extracted from the taint information database. Default to <code>/tmp/taint.out</code> if not specified.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md389"></a>
References</h1>
<p>[^ndss17]: Sanjay Rawat, Vivek Jain, Ashish Kumar, Lucian Cojocar, Cristiano Giuffrida, and Herbert Bos. 2017. VUzzer: Application-aware Evolutionary Fuzzing. In the Network and Distribution System Security (NDSSâ€™17). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
