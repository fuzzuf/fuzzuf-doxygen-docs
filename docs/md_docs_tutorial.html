<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fuzzuf: Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">fuzzuf
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document covers how to use fuzzuf as a collection of fuzzers in a step-by-step manner. Please refer to other documents if you want to use fuzzuf as a framework for building a new fuzzer.</p>
<h1><a class="anchor" id="autotoc_md12516"></a>
Building fuzzuf</h1>
<p>We recommend to use Ubuntu 20.04 (or 18.04) as the operating system to build fuzzuf.</p>
<p>For Ubuntu 20.04, follow the below instruction to build fuzzuf.</p>
<div class="fragment"><div class="line">$ sudo apt update</div>
<div class="line">$ sudo apt install -y \</div>
<div class="line">  build-essential cmake git libboost-all-dev \</div>
<div class="line">  python3 nlohmann-json3-dev pybind11-dev libcrypto++-dev</div>
<div class="line">$ git clone https://github.com/fuzzuf/fuzzuf.git</div>
<div class="line">$ cd fuzzuf</div>
<div class="line">$ cmake -B build -DCMAKE_BUILD_TYPE=Release # Change to &quot;Debug&quot; if you want to show debug logs</div>
<div class="line">$ cmake --build build -j$(nproc)</div>
</div><!-- fragment --><p>On Ubuntu 18.04, execute the following commands instead. <br  />
</p>
<div class="fragment"><div class="line">$ sudo apt update</div>
<div class="line">$ sudo apt install -y \</div>
<div class="line">  build-essential cmake git libboost-all-dev \</div>
<div class="line">  nlohmann-json-dev pybind11-dev libcrypto++-dev</div>
<div class="line">$ git clone https://github.com/fuzzuf/fuzzuf.git</div>
<div class="line">$ mkdir fuzzuf/build</div>
<div class="line">$ cd $_</div>
<div class="line">$ cmake ../ -DCMAKE_BUILD_TYPE=Release # Need to use a legacy CMake command as apt installs old one</div>
<div class="line">$ make -j$(nproc)</div>
</div><!-- fragment --><p>Refer to the building.md for more detailed build instruction.</p>
<h1><a class="anchor" id="autotoc_md12517"></a>
Fuzzing with fuzzuf</h1>
<p>This section shows how to run fuzzing with fuzzuf. We use a JPEG Exif parser <code>exifutil</code> as a PUT (Program Under Test). The source code is located in <a href="/docs/resources/exifutil">docs/resources/exifutil</a>. To perform fuzzing, we have to instrument programs. To do this, install <code>afl++-clang</code> (or <code>afl-clang</code>) package for the compiler wrapper.</p>
<p>Hit the following commands to install the compiler wrapper, and build <code>exifutil</code> with instrumentations.</p>
<div class="fragment"><div class="line">$ # The following package is only available on Ubuntu 20.04+. </div>
<div class="line">$ # Install afl-clang instead on older Ubuntu releases.</div>
<div class="line">$ # Both packages install afl-clang-fast.</div>
<div class="line">$ sudo apt install -y afl++-clang</div>
<div class="line">$ pushd docs/resources/exifutil</div>
<div class="line">$ CC=afl-clang-fast make</div>
<div class="line">$ popd</div>
</div><!-- fragment --><p>Next, we need at least one initial seed for fuzzing. As the program is a JPEG parser, prepare an image such as <a href="/docs/resources/exifutil/fuzz_input/jpeg.jpg">docs/resources/exifutil/fuzz_input/jpeg.jpg</a>. Fuzzers use it as an initial test case for the PUT before applying any kinds of mutations. Now we can use the <code>fuzzuf</code> executable for fuzzing! Hit the following command to start it with AFL fuzzer:</p>
<div class="fragment"><div class="line">$ mkdir /tmp/input # Create a directory for an initial seed</div>
<div class="line">$ cp /path/to/jpeg/image.jpg /tmp/input</div>
<div class="line">$ cd /path/to/fuzzuf/build</div>
<div class="line">$ ./fuzzuf afl --in_dir=/tmp/input \</div>
<div class="line">  --out_dir=/tmp/out.afl -- \</div>
<div class="line">  ../docs/resources/exifutil/exifutil -f @@</div>
</div><!-- fragment --><p>Note that <code>-f</code> is an option given to the PUT itself.</p>
<p>If the above command is executed successfully, the following user interface is shown on the terminal, and the fuzzing begins.</p>
<p><img src="/docs/resources/img/fuzzuf-afl-exifutil.png" alt="fuzzuf-afl-exifutil" class="inline"/></p>
<p>During fuzzing, PUT is executed repeatedly with various mutated inputs. If the execution crashes or hangs, the fuzzer will save the input. Specifically, suppose the fuzzer found a unique input that crashes the PUT. In that case, it will save the input to the <code>/tmp/out.afl/crashes</code> directory and increment the <code>unique crashes</code> counter in the upper-right of the UI. To stop fuzzing, hit <code>Ctrl-C</code> to send <code>SIGINT</code> to the <code>fuzzuf</code> process. Check the inputs triggered crashes and hangs to analyze the root causes.</p>
<h1><a class="anchor" id="autotoc_md12518"></a>
Changing Fuzzer</h1>
<p>fuzzuf provides various fuzzers other than AFL. Next, we are going to use AFLFast to fuzz the same executable. Please read AFLFast document to know the characteristics of the AFLFast fuzzer. To change the fuzzer used, we only have to modify the command line argument (and local options).</p>
<div class="fragment"><div class="line">$ ./fuzzuf aflfast --in_dir=/tmp/input \</div>
<div class="line">  --out_dir=/tmp/out.aflfast \</div>
<div class="line">  ../docs/resources/exifutil/exifutil -f @@</div>
</div><!-- fragment --><p><img src="/docs/resources/img/fuzzuf-aflfast-exifutil.png" alt="fuzzuf-aflfast-exifutil" class="inline"/></p>
<p>A power scheduling adopted in AFLFast increases fuzzer performance from the original AFL when it is run for a long enough time. For more details, please refer to the document listed above.</p>
<p>If you want to try other fuzzers, similarly change the command line arguments and options. You may have to apply different processes to the PUT, depending on the fuzzer used. Please refer to the <a href="/docs/algorithms">document directory</a> to know how to use fuzzers. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
