<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fuzzuf: include/fuzzuf/algorithms/nezha/executor/add_to_solution.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">fuzzuf
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_bf43598f184c4738baed24c698eda399.html">fuzzuf</a></li><li class="navelem"><a class="el" href="dir_2817d3aab5ec51b483dcf765dd20c8bf.html">algorithms</a></li><li class="navelem"><a class="el" href="dir_8a3c9cd1eeaa81c7252e3e9a90755cd3.html">nezha</a></li><li class="navelem"><a class="el" href="dir_ac8dc09b543e371d86882b1ca68a93bc.html">executor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">add_to_solution.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;type_traits&gt;</code><br />
<code>#include &quot;<a class="el" href="libfuzzer_2corpus_2add__to__solution_8hpp_source.html">fuzzuf/algorithms/libfuzzer/corpus/add_to_solution.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="corpus_8hpp_source.html">fuzzuf/algorithms/libfuzzer/state/corpus.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="input__info_8hpp_source.html">fuzzuf/algorithms/libfuzzer/state/input_info.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nezha_2state_8hpp_source.html">fuzzuf/algorithms/nezha/state.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="range__traits_8hpp_source.html">fuzzuf/utils/range_traits.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="to__string_8hpp_source.html">fuzzuf/utils/to_string.hpp</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for add_to_solution.hpp:</div>
<div class="dyncontent">
<div class="center"><img src="nezha_2executor_2add__to__solution_8hpp__incl.png" border="0" usemap="#include_2fuzzuf_2algorithms_2nezha_2executor_2add__to__solution_8hpp" alt=""/></div>
<map name="include_2fuzzuf_2algorithms_2nezha_2executor_2add__to__solution_8hpp" id="include_2fuzzuf_2algorithms_2nezha_2executor_2add__to__solution_8hpp">
<area shape="rect" title=" " alt="" coords="1676,5,1863,61"/>
<area shape="rect" title=" " alt="" coords="3198,735,3290,761"/>
<area shape="rect" href="libfuzzer_2corpus_2add__to__solution_8hpp.html" title=" " alt="" coords="1465,109,1669,151"/>
<area shape="rect" href="corpus_8hpp.html" title=" " alt="" coords="1079,199,1275,240"/>
<area shape="rect" href="input__info_8hpp.html" title=" " alt="" coords="1757,377,1953,419"/>
<area shape="rect" href="range__traits_8hpp.html" title=" " alt="" coords="3258,467,3393,508"/>
<area shape="rect" href="to__string_8hpp.html" title=" " alt="" coords="2778,385,2961,411"/>
<area shape="rect" href="nezha_2state_8hpp.html" title=" " alt="" coords="3796,377,3975,419"/>
<area shape="rect" title=" " alt="" coords="600,653,685,679"/>
<area shape="rect" title=" " alt="" coords="507,653,576,679"/>
<area shape="rect" title=" " alt="" coords="711,653,785,679"/>
<area shape="rect" title=" " alt="" coords="3447,653,3518,679"/>
<area shape="rect" href="exit__status__feedback_8hpp_source.html" title=" " alt="" coords="1282,467,1446,508"/>
<area shape="rect" href="exec__input__set_8hpp_source.html" title=" " alt="" coords="1055,288,1225,329"/>
<area shape="rect" href="libfuzzer_2state_2state_8hpp.html" title=" " alt="" coords="2346,199,2542,240"/>
<area shape="rect" href="native__linux__executor_8hpp_source.html" title=" " alt="" coords="1097,377,1263,419"/>
<area shape="rect" href="sha1_8hpp.html" title=" " alt="" coords="2276,563,2433,590"/>
<area shape="rect" title=" " alt="" coords="590,288,781,329"/>
<area shape="rect" title=" " alt="" coords="805,295,1030,322"/>
<area shape="rect" title=" " alt="" coords="93,288,307,329"/>
<area shape="rect" title=" " alt="" coords="331,295,565,322"/>
<area shape="rect" title=" " alt="" coords="2130,563,2201,590"/>
<area shape="rect" title=" " alt="" coords="1824,653,1883,679"/>
<area shape="rect" title=" " alt="" coords="2166,653,2229,679"/>
<area shape="rect" title=" " alt="" coords="2231,474,2297,501"/>
<area shape="rect" title=" " alt="" coords="1509,653,1576,679"/>
<area shape="rect" title=" " alt="" coords="809,653,884,679"/>
<area shape="rect" title=" " alt="" coords="2829,563,2889,590"/>
<area shape="rect" href="testcase__id_8hpp.html" title=" " alt="" coords="1258,556,1454,597"/>
<area shape="rect" href="void__t_8hpp.html" title=" " alt="" coords="3161,653,3327,679"/>
<area shape="rect" title=" " alt="" coords="909,653,995,679"/>
<area shape="rect" title=" " alt="" coords="351,653,428,679"/>
<area shape="rect" href="put__exit__reason__type_8hpp_source.html" title=" " alt="" coords="1682,556,1851,597"/>
<area shape="rect" href="common_8hpp_source.html" title=" " alt="" coords="731,563,914,590"/>
<area shape="rect" title=" " alt="" coords="2458,653,2513,679"/>
<area shape="rect" href="check__capability_8hpp.html" title=" " alt="" coords="3332,556,3468,597"/>
<area shape="rect" href="remove__cvr_8hpp.html" title=" " alt="" coords="2843,645,3011,687"/>
<area shape="rect" href="exec__input_8hpp_source.html" title=" " alt="" coords="260,467,431,508"/>
<area shape="rect" href="on__disk__exec__input_8hpp_source.html" title=" " alt="" coords="459,377,621,419"/>
<area shape="rect" href="on__memory__exec__input_8hpp_source.html" title=" " alt="" coords="195,377,384,419"/>
<area shape="rect" href="libfuzzer_2config_8hpp.html" title=" " alt="" coords="2287,377,2483,419"/>
<area shape="rect" href="random__traits_8hpp.html" title=" " alt="" coords="3417,467,3613,508"/>
<area shape="rect" href="libfuzzer_2utils_8hpp.html" title=" " alt="" coords="2559,288,2755,329"/>
<area shape="rect" href="version_8hpp.html" title=" " alt="" coords="2210,288,2406,329"/>
<area shape="rect" title=" " alt="" coords="2829,467,2979,508"/>
<area shape="rect" href="equality__comparable_8hpp.html" title=" " alt="" coords="3015,556,3206,597"/>
<area shape="rect" title=" " alt="" coords="911,474,1003,501"/>
<area shape="rect" href="afl__edge__cov__attacher_8hpp.html" title=" " alt="" coords="1028,467,1207,508"/>
<area shape="rect" title=" " alt="" coords="3797,474,3987,501"/>
<area shape="rect" title=" " alt="" coords="4012,474,4127,501"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="nezha_2executor_2add__to__solution_8hpp__dep__incl.png" border="0" usemap="#include_2fuzzuf_2algorithms_2nezha_2executor_2add__to__solution_8hppdep" alt=""/></div>
<map name="include_2fuzzuf_2algorithms_2nezha_2executor_2add__to__solution_8hppdep" id="include_2fuzzuf_2algorithms_2nezha_2executor_2add__to__solution_8hppdep">
<area shape="rect" title=" " alt="" coords="111,5,297,61"/>
<area shape="rect" href="nezha_2execute_8hpp.html" title=" " alt="" coords="5,117,192,158"/>
<area shape="rect" href="nezha_2hierarflow_2add__to__solution_8hpp.html" title=" " alt="" coords="216,109,403,165"/>
<area shape="rect" href="nezha_2hierarflow_8hpp.html" title=" " alt="" coords="216,213,403,255"/>
<area shape="rect" href="nezha_2create_8hpp.html" title=" " alt="" coords="151,303,337,344"/>
<area shape="rect" href="output__hash2_8cpp_source.html" title=" " alt="" coords="293,392,457,433"/>
<area shape="rect" href="nezha_2fuzzer_8cpp.html" title=" " alt="" coords="63,399,268,426"/>
</map>
</div>
</div>
<p><a href="nezha_2executor_2add__to__solution_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae54612708d8a3c6545f3c11c613e22ab"><td class="memTemplParams" colspan="2">template&lt;typename Range , typename Output &gt; </td></tr>
<tr class="memitem:ae54612708d8a3c6545f3c11c613e22ab"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="nezha_2executor_2add__to__solution_8hpp.html#ae54612708d8a3c6545f3c11c613e22ab">fuzzuf::algorithm::nezha::executor::AddToSolution</a> (Range &amp;range, libfuzzer::InputInfo &amp;exec_result, const trace_t &amp;trace, known_traces_t &amp;trace_hash, const Output &amp;outputs, known_outputs_t &amp;outputs_hash, const fs::path &amp;path_prefix) -&gt; std::enable_if_t&lt; utils::range::is_range_of_v&lt; Range, std::uint8_t &gt; &amp;&amp;utils::range::has_data_v&lt; Range &gt;, bool &gt;</td></tr>
<tr class="memdesc:ae54612708d8a3c6545f3c11c613e22ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert execution result to solutions if the tuple of outputs is novel or only part of coverage tuple contain novel features and at least two targets produced diferent standard output.  <a href="nezha_2executor_2add__to__solution_8hpp.html#ae54612708d8a3c6545f3c11c613e22ab">More...</a><br /></td></tr>
<tr class="separator:ae54612708d8a3c6545f3c11c613e22ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accf94dac5c2d2d01fe4a70bbd3a8844f"><td class="memTemplParams" colspan="2">template&lt;typename Range &gt; </td></tr>
<tr class="memitem:accf94dac5c2d2d01fe4a70bbd3a8844f"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="nezha_2executor_2add__to__solution_8hpp.html#accf94dac5c2d2d01fe4a70bbd3a8844f">fuzzuf::algorithm::nezha::executor::AddToSolution</a> (Range &amp;range, libfuzzer::InputInfo &amp;exec_result, const trace_t &amp;trace, known_traces_t &amp;trace_hash, const status_t &amp;status, known_status_t &amp;status_hash, const fs::path &amp;path_prefix) -&gt; std::enable_if_t&lt; utils::range::is_range_of_v&lt; Range, std::uint8_t &gt; &amp;&amp;utils::range::has_data_v&lt; Range &gt;, bool &gt;</td></tr>
<tr class="memdesc:accf94dac5c2d2d01fe4a70bbd3a8844f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert execution result to solutions if the tuple of status code is novel or only part of coverage tuple contain novel features and only part of targets exited as success( status code = 0 ).  <a href="nezha_2executor_2add__to__solution_8hpp.html#accf94dac5c2d2d01fe4a70bbd3a8844f">More...</a><br /></td></tr>
<tr class="separator:accf94dac5c2d2d01fe4a70bbd3a8844f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Ricerca Security <a href="#" onclick="location.href='mai'+'lto:'+'fuz'+'zu'+'f-d'+'ev'+'@ri'+'cs'+'ec.'+'co'+'.jp'; return false;">fuzzu<span style="display: none;">.nosp@m.</span>f-de<span style="display: none;">.nosp@m.</span>v@ric<span style="display: none;">.nosp@m.</span>sec.<span style="display: none;">.nosp@m.</span>co.jp</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="nezha_2executor_2add__to__solution_8hpp_source.html">add_to_solution.hpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae54612708d8a3c6545f3c11c613e22ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae54612708d8a3c6545f3c11c613e22ab">&#9670;&nbsp;</a></span>AddToSolution() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Range , typename Output &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto fuzzuf::algorithm::nezha::executor::AddToSolution </td>
          <td>(</td>
          <td class="paramtype">Range &amp;&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfuzzuf_1_1algorithm_1_1libfuzzer_1_1InputInfo.html">libfuzzer::InputInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>exec_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const trace_t &amp;&#160;</td>
          <td class="paramname"><em>trace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">known_traces_t &amp;&#160;</td>
          <td class="paramname"><em>trace_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Output &amp;&#160;</td>
          <td class="paramname"><em>outputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">known_outputs_t &amp;&#160;</td>
          <td class="paramname"><em>outputs_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const fs::path &amp;&#160;</td>
          <td class="paramname"><em>path_prefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> -&gt; std::enable_if_t&lt;utils::range::is_range_of_v&lt;Range, std::uint8_t&gt; &amp;&amp;
                            utils::range::has_data_v&lt;Range&gt;,
                        bool&gt; </td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert execution result to solutions if the tuple of outputs is novel or only part of coverage tuple contain novel features and at least two targets produced diferent standard output. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Range</td><td>Contiguous Range of std::uint8_t </td></tr>
    <tr><td class="paramname">Output</td><td>Range of std::uint8_t </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">range</td><td>Input value that was passed to the executor </td></tr>
    <tr><td class="paramname">exec_result</td><td>Execution result that was produced by the executor </td></tr>
    <tr><td class="paramname">trace</td><td>Range of bool that indicates execution result on each targets that had been added to corpus. </td></tr>
    <tr><td class="paramname">trace_hash</td><td>Previously appeared value of trace </td></tr>
    <tr><td class="paramname">outputs</td><td>Range of hash value of standard output </td></tr>
    <tr><td class="paramname">outputs_hash</td><td>Previously appeared value of outputs </td></tr>
    <tr><td class="paramname">path_prefix</td><td>Directory to output solutions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return true if the input is added to solutions. Otherwise, return false. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nezha_2executor_2add__to__solution_8hpp_source.html#l00053">53</a> of file <a class="el" href="nezha_2executor_2add__to__solution_8hpp_source.html">add_to_solution.hpp</a>.</p>

</div>
</div>
<a id="accf94dac5c2d2d01fe4a70bbd3a8844f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accf94dac5c2d2d01fe4a70bbd3a8844f">&#9670;&nbsp;</a></span>AddToSolution() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Range &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto fuzzuf::algorithm::nezha::executor::AddToSolution </td>
          <td>(</td>
          <td class="paramtype">Range &amp;&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfuzzuf_1_1algorithm_1_1libfuzzer_1_1InputInfo.html">libfuzzer::InputInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>exec_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const trace_t &amp;&#160;</td>
          <td class="paramname"><em>trace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">known_traces_t &amp;&#160;</td>
          <td class="paramname"><em>trace_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const status_t &amp;&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">known_status_t &amp;&#160;</td>
          <td class="paramname"><em>status_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const fs::path &amp;&#160;</td>
          <td class="paramname"><em>path_prefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> -&gt; std::enable_if_t&lt;utils::range::is_range_of_v&lt;Range, std::uint8_t&gt; &amp;&amp;
                            utils::range::has_data_v&lt;Range&gt;,
                        bool&gt; </td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert execution result to solutions if the tuple of status code is novel or only part of coverage tuple contain novel features and only part of targets exited as success( status code = 0 ). </p>
<p>Corresponding code of original Nezha implementation <a href="https://github.com/nezha-dt/nezha/blob/master/Fuzzer/FuzzerLoop.cpp#L165">https://github.com/nezha-dt/nezha/blob/master/Fuzzer/FuzzerLoop.cpp#L165</a></p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Range</td><td>Contiguous Range of std::uint8_t </td></tr>
    <tr><td class="paramname">Output</td><td>Range of std::uint8_t </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">range</td><td>Input value that was passed to the executor </td></tr>
    <tr><td class="paramname">exec_result</td><td>Execution result that was produced by the executor </td></tr>
    <tr><td class="paramname">trace</td><td>Range of bool that indicates execution result on each targets that had been added to corpus. </td></tr>
    <tr><td class="paramname">trace_hash</td><td>Previously appeared value of trace </td></tr>
    <tr><td class="paramname">status</td><td>Range of status code </td></tr>
    <tr><td class="paramname">status_hash</td><td>Previously appeared value of status @params path_prefix Directory to output solutions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return true if the input is added to solutions. Otherwise, return false. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nezha_2executor_2add__to__solution_8hpp_source.html#l00101">101</a> of file <a class="el" href="nezha_2executor_2add__to__solution_8hpp_source.html">add_to_solution.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
